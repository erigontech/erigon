package tests

import (
	"encoding/json"
	"errors"
	"fmt"
	"strings"
	"testing"

	"github.com/erigontech/erigon-lib/common/hexutil"
	"github.com/erigontech/erigon/core/vm"
)

// A BlockTest checks handling of entire blocks.
type EOFTest struct {
	json eofJSON
}

// UnmarshalJSON implements json.Unmarshaler interface.
func (e *EOFTest) UnmarshalJSON(in []byte) error {
	return json.Unmarshal(in, &e.json)
}

type eofJSON struct {
	Vector _vector `json:"vectors"`
}

type _vector struct {
	Index _index `json:"0"`
}

type _index struct {
	Code          string `json:"code"`
	ContainerKind string `json:"containerKind"`
	Result        struct {
		Osaka struct {
			Exception string `json:"exception"`
			Result    bool   `json:"result"`
		} `json:"Osaka"`
	} `json:"results"`
}

func parseError(err error) error {
	var _errors = []error{ // add new errors here
		vm.ErrIncompatibleContainer,
		vm.ErrAmbiguousContainer,
		vm.ErrInvalidSectionsSize,
		vm.ErrInvalidCodeTermination,
		vm.ErrInvalidMagic,
		vm.ErrOrphanSubContainer,
		vm.ErrTopLevelTruncated,
		vm.ErrIncompleteEOF,
		vm.ErrInvalidVersion,
		vm.ErrTooManyContainerSections,
		vm.ErrTooLargeByteCode,
		vm.ErrInvalidMaxStackHeight,
		vm.ErrTooLargeMaxStackHeight,
		vm.ErrEOFStackUnderflow,
		vm.ErrUndefinedInstruction,
		vm.ErrUnreachableCode,
		vm.ErrTruncatedImmediate,
		vm.ErrMissingTypeHeader,
		vm.ErrInvalidTypeSize,
		vm.ErrInvalidSectionCount,
		vm.ErrInvalidFirstSectionType,
		vm.ErrTooManyInputs,
		vm.ErrTooManyOutputs,
		vm.ErrMissingCodeHeader,
		vm.ErrMissingDataHeader,
		vm.ErrInvalidCodeSize,
		vm.ErrInvalidContainerSize,
		vm.ErrMissingTerminator,
		vm.ErrZeroSizeContainerSection,
		vm.ErrUnreachableCodeSections,
		vm.ErrInvalidRjumpDest,
		vm.ErrStackHeightMismatch,
		vm.ErrEOFStackOverflow,
		vm.ErrStackHeightHigher,
		vm.ErrInvalidSectionArgument,
		vm.ErrInvalidNonReturning,
		vm.ErrJUMPFOutputs,
		vm.ErrInvalidDataLoadN,
		vm.ErrInvalidContainerArgument,
		vm.ErrEOFCreateWithTruncatedContainer,
	}

	for _, _err := range _errors {
		if errors.Is(err, _err) {
			return _err
		}
	}
	return nil
}

var errorsMap = map[string][]error{
	"EOFException.INCOMPATIBLE_CONTAINER_KIND": []error{vm.ErrIncompatibleContainer, vm.ErrAmbiguousContainer},
	"EOFException.INVALID_SECTION_BODIES_SIZE": []error{
		vm.ErrInvalidSectionsSize, vm.ErrInvalidSectionCount, vm.ErrInvalidTypeSize},
	"EOFException.MISSING_STOP_OPCODE":            []error{vm.ErrInvalidCodeTermination},
	"EOFException.INVALID_MAGIC":                  []error{vm.ErrInvalidMagic, vm.ErrIncompleteEOF},
	"EOFException.ORPHAN_SUBCONTAINER":            []error{vm.ErrOrphanSubContainer},
	"EOFException.TOPLEVEL_CONTAINER_TRUNCATED":   []error{vm.ErrTopLevelTruncated},
	"EOFException.INVALID_VERSION":                []error{vm.ErrInvalidVersion, vm.ErrIncompleteEOF},
	"EOFException.TOO_MANY_CONTAINERS":            []error{vm.ErrTooManyContainerSections},
	"EOFException.CONTAINER_SIZE_ABOVE_LIMIT":     []error{vm.ErrTooLargeByteCode},
	"EOFException.INVALID_MAX_STACK_HEIGHT":       []error{vm.ErrInvalidMaxStackHeight},
	"EOFException.MAX_STACK_HEIGHT_ABOVE_LIMIT":   []error{vm.ErrTooLargeMaxStackHeight},
	"EOFException.STACK_UNDERFLOW":                []error{vm.ErrEOFStackUnderflow},
	"EOFException.UNDEFINED_INSTRUCTION":          []error{vm.ErrUndefinedInstruction},
	"EOFException.UNREACHABLE_INSTRUCTIONS":       []error{vm.ErrUnreachableCode},
	"EOFException.TRUNCATED_INSTRUCTION":          []error{vm.ErrTruncatedImmediate},
	"EOFException.MISSING_TYPE_HEADER":            []error{vm.ErrMissingTypeHeader, vm.ErrIncompleteEOF},
	"EOFException.INVALID_TYPE_SECTION_SIZE":      []error{vm.ErrInvalidTypeSize, vm.ErrInvalidSectionCount},
	"EOFException.INVALID_FIRST_SECTION_TYPE":     []error{vm.ErrInvalidFirstSectionType, vm.ErrTopLevelTruncated},
	"EOFException.TOO_MANY_CODE_SECTIONS":         []error{vm.ErrIncompleteEOF, vm.ErrInvalidTypeSize},
	"EOFException.INCOMPLETE_SECTION_NUMBER":      []error{vm.ErrIncompleteEOF},
	"EOFException.INPUTS_OUTPUTS_NUM_ABOVE_LIMIT": []error{vm.ErrTooManyInputs, vm.ErrTooManyOutputs},
	"EOFException.MISSING_HEADERS_TERMINATOR": []error{
		vm.ErrIncompleteEOF, vm.ErrInvalidContainerSize, vm.ErrMissingTerminator, vm.ErrMissingDataHeader},
	"EOFException.INCOMPLETE_SECTION_SIZE": []error{
		vm.ErrIncompleteEOF, vm.ErrMissingDataHeader, vm.ErrInvalidContainerSize},
	"EOFException.ZERO_SECTION_SIZE": []error{
		vm.ErrIncompleteEOF, vm.ErrInvalidTypeSize, vm.ErrInvalidCodeSize, vm.ErrZeroSizeContainerSection, vm.ErrInvalidSectionCount, vm.ErrInvalidContainerSize},
	"EOFException.MISSING_CODE_HEADER":                    []error{vm.ErrMissingCodeHeader, vm.ErrIncompleteEOF},
	"EOFException.MISSING_DATA_SECTION":                   []error{vm.ErrMissingDataHeader, vm.ErrInvalidSectionCount},
	"EOFException.MISSING_TERMINATOR":                     []error{vm.ErrMissingTerminator, vm.ErrInvalidSectionCount},
	"EOFException.UNEXPECTED_HEADER_KIND":                 []error{vm.ErrMissingTypeHeader},
	"EOFException.UNREACHABLE_CODE_SECTIONS":              []error{vm.ErrUnreachableCodeSections, vm.ErrInvalidNonReturning, vm.ErrTopLevelTruncated},
	"EOFException.INVALID_RJUMP_DESTINATION":              []error{vm.ErrInvalidRjumpDest},
	"EOFException.STACK_HEIGHT_MISMATCH":                  []error{vm.ErrStackHeightMismatch},
	"EOFException.STACK_OVERFLOW":                         []error{vm.ErrEOFStackOverflow},
	"EOFException.STACK_HIGHER_THAN_OUTPUTS":              []error{vm.ErrStackHeightHigher},
	"EOFException.INVALID_CODE_SECTION_INDEX":             []error{vm.ErrInvalidSectionArgument},
	"EOFException.INVALID_NON_RETURNING_FLAG":             []error{vm.ErrInvalidNonReturning},
	"EOFException.JUMPF_DESTINATION_INCOMPATIBLE_OUTPUTS": []error{vm.ErrJUMPFOutputs},
	"EOFException.CALLF_TO_NON_RETURNING":                 []error{vm.ErrInvalidSectionArgument},
	"EOFException.INVALID_DATALOADN_INDEX":                []error{vm.ErrInvalidDataLoadN},
	"EOFException.INVALID_CONTAINER_SECTION_INDEX":        []error{vm.ErrInvalidContainerArgument},
	"EOFException.EOFCREATE_WITH_TRUNCATED_CONTAINER":     []error{vm.ErrEOFCreateWithTruncatedContainer},
}

func mapError(exception string, err error) bool {

	cmp := parseError(err)

	if cmp == nil {
		fmt.Println("Add err to the error array", err)
		panic("add err to getError func")
	}

	errs := errorsMap[exception]
	if len(errs) == 0 {
		fmt.Printf("exception was not added to map: %s\n", exception)
		panic("no mapped errors found for exception")
	}

	for _, er := range errs {
		if er == cmp {
			return true
		}
	}
	return false
}

func (e *EOFTest) Run(t *testing.T) error {
	hexCode := e.json.Vector.Index.Code
	// fmt.Println("hexCode: ", hexCode)
	result := e.json.Vector.Index.Result.Osaka.Result // TODO(racytech): revisit this part, think about result=true -> what to expect from test?
	exception := e.json.Vector.Index.Result.Osaka.Exception
	containerKind := e.json.Vector.Index.ContainerKind
	code, err := hexutil.Decode(hexCode)
	if err != nil {
		return fmt.Errorf("error decoding hex string: %v", hexCode)
	}
	fmt.Println("result: ", result)
	fmt.Println("exception: ", exception)
	fmt.Println("eof code size: ", len(code))
	fmt.Println("containerKind: ", containerKind)

	var _cotainerKind byte
	if containerKind == "RUNTIME" {
		_cotainerKind = 1
	}
	eofJt := vm.NewEOFInstructionSet()
	// var c vm.Container
	arr := strings.Split(exception, "|")

	if _, err := vm.UnmarshalEOF(code, 0, byte(_cotainerKind), &eofJt, true); err != nil {
		fmt.Println("------------------ got err, ", err)
		if !result { // if we do expect fail and got an error
			var found bool
			for _, exception := range arr {
				found = mapError(exception, err)
				if found {
					break
				}
			}
			if !found {
				t.Errorf("test did not pass: expected err: %v, got err: %v", exception, err.Error())
			}
		} else { // if we do not expect fail and got an error
			fmt.Println(err)
			t.Errorf("test did not pass: expected err: nil, got err: %v", err.Error())
		}
	} else {
		fmt.Println("------------------ no err")
		if !result { // if do expect fail, but did not got an error
			t.Errorf("test did not pass: expected err: %v, got err: nil", arr[0])
		} else { // if we do not expect fail and did not got and error
			// skip
		}
		fmt.Println("unmarshal no error")
		fmt.Println(err)
		// vm.MarshalEOF(cont, 0)
	}
	return nil
}

// given code 0xef00010100100200040008000a00040006040000000080000200000001008000000000000260006000e3000100600035e10001e4e50002e30003006001600055e4
// 0x
// ef00 - magic
// 01 - version
// 01 - kind type
// 0010 - type sizes (16/4=4 type sections)
// 02 - kind code
// 0004 - num code sections (4)
// 0008 - 1st code section size
// 000a - 2nd
// 0004 - 3d
// 0006 - 4th
// 04 - kind data
// 0000 - data size
// 00 - terminator
// 00 - inputs 1st type section
// 80 - outputs 1st type section (non returning function)
// 0002 - max stack height 1st section
// 00 - inputs 2nd
// 00 - outputs 2nd
// 0001 - max stack height 2nd
// 00 - inputs 3d
// 80 - outputs 3d (non returning function)
// 0000 - max stack height 3d
// 00 - inputs 4th
// 00 - outputs 4th
// 0002 - max stack heitgh 4th
// 60006000e3000100 - 1st code
// 600035e10001e4e50002 - 2nd code
// e3000300 - 3d code
// 6001600055e4 - 4th code

// 0x
// ef00
// 01
// 01
// 0008
// 02
// 0002
// 0003
// 0003
// 04
// 0004
// 00
// 00
// 80
// 0001
// 00
// 00
// 0000
// 30 50 00 0b ad 60 a7

// 0xef00
// 01 - version
// 01 - kind type
// 0004
// 02
// 0001
// 0b05
// 03
// 0100
// 0014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014001400140014
// 04
// 0000
// 00
// 00
// 80
// 0002
// 6000
// e10006
// 60006000ee006000e1000660006000ee016000e1000660006000ee026000e1000660006000ee036000e1000660006000ee046000e1000660006000ee056000e1000660006000ee066000e1000660006000ee076000e1000660006000ee086000e1000660006000ee096000e1000660006000ee0a6000e1000660006000ee0b6000e1000660006000ee0c6000e1000660006000ee0d6000e1000660006000ee0e6000e1000660006000ee0f6000e1000660006000ee106000e1000660006000ee116000e1000660006000ee126000e1000660006000ee136000e1000660006000ee146000e1000660006000ee156000e1000660006000ee166000e1000660006000ee176000e1000660006000ee186000e1000660006000ee196000e1000660006000ee1a6000e1000660006000ee1b6000e1000660006000ee1c6000e1000660006000ee1d6000e1000660006000ee1e6000e1000660006000ee1f6000e1000660006000ee206000e1000660006000ee216000e1000660006000ee226000e1000660006000ee236000e1000660006000ee246000e1000660006000ee256000e1000660006000ee266000e1000660006000ee276000e1000660006000ee286000e1000660006000ee296000e1000660006000ee2a6000e1000660006000ee2b6000e1000660006000ee2c6000e1000660006000ee2d6000e1000660006000ee2e6000e1000660006000ee2f6000e1000660006000ee306000e1000660006000ee316000e1000660006000ee326000e1000660006000ee336000e1000660006000ee346000e1000660006000ee356000e1000660006000ee366000e1000660006000ee376000e1000660006000ee386000e1000660006000ee396000e1000660006000ee3a6000e1000660006000ee3b6000e1000660006000ee3c6000e1000660006000ee3d6000e1000660006000ee3e6000e1000660006000ee3f6000e1000660006000ee406000e1000660006000ee416000e1000660006000ee426000e1000660006000ee436000e1000660006000ee446000e1000660006000ee456000e1000660006000ee466000e1000660006000ee476000e1000660006000ee486000e1000660006000ee496000e1000660006000ee4a6000e1000660006000ee4b6000e1000660006000ee4c6000e1000660006000ee4d6000e1000660006000ee4e6000e1000660006000ee4f6000e1000660006000ee506000e1000660006000ee516000e1000660006000ee526000e1000660006000ee536000e1000660006000ee546000e1000660006000ee556000e1000660006000ee566000e1000660006000ee576000e1000660006000ee586000e1000660006000ee596000e1000660006000ee5a6000e1000660006000ee5b6000e1000660006000ee5c6000e1000660006000ee5d6000e1000660006000ee5e6000e1000660006000ee5f6000e1000660006000ee606000e1000660006000ee616000e1000660006000ee626000e1000660006000ee636000e1000660006000ee646000e1000660006000ee656000e1000660006000ee666000e1000660006000ee676000e1000660006000ee686000e1000660006000ee696000e1000660006000ee6a6000e1000660006000ee6b6000e1000660006000ee6c6000e1000660006000ee6d6000e1000660006000ee6e6000e1000660006000ee6f6000e1000660006000ee706000e1000660006000ee716000e1000660006000ee726000e1000660006000ee736000e1000660006000ee746000e1000660006000ee756000e1000660006000ee766000e1000660006000ee776000e1000660006000ee786000e1000660006000ee796000e1000660006000ee7a6000e1000660006000ee7b6000e1000660006000ee7c6000e1000660006000ee7d6000e1000660006000ee7e6000e1000660006000ee7f6000e1000660006000ee806000e1000660006000ee816000e1000660006000ee826000e1000660006000ee836000e1000660006000ee846000e1000660006000ee856000e1000660006000ee866000e1000660006000ee876000e1000660006000ee886000e1000660006000ee896000e1000660006000ee8a6000e1000660006000ee8b6000e1000660006000ee8c6000e1000660006000ee8d6000e1000660006000ee8e6000e1000660006000ee8f6000e1000660006000ee906000e1000660006000ee916000e1000660006000ee926000e1000660006000ee936000e1000660006000ee946000e1000660006000ee956000e1000660006000ee966000e1000660006000ee976000e1000660006000ee986000e1000660006000ee996000e1000660006000ee9a6000e1000660006000ee9b6000e1000660006000ee9c6000e1000660006000ee9d6000e1000660006000ee9e6000e1000660006000ee9f6000e1000660006000eea06000e1000660006000eea16000e1000660006000eea26000e1000660006000eea36000e1000660006000eea46000e1000660006000eea56000e1000660006000eea66000e1000660006000eea76000e1000660006000eea86000e1000660006000eea96000e1000660006000eeaa6000e1000660006000eeab6000e1000660006000eeac6000e1000660006000eead6000e1000660006000eeae6000e1000660006000eeaf6000e1000660006000eeb06000e1000660006000eeb16000e1000660006000eeb26000e1000660006000eeb36000e1000660006000eeb46000e1000660006000eeb56000e1000660006000eeb66000e1000660006000eeb76000e1000660006000eeb86000e1000660006000eeb96000e1000660006000eeba6000e1000660006000eebb6000e1000660006000eebc6000e1000660006000eebd6000e1000660006000eebe6000e1000660006000eebf6000e1000660006000eec06000e1000660006000eec16000e1000660006000eec26000e1000660006000eec36000e1000660006000eec46000e1000660006000eec56000e1000660006000eec66000e1000660006000eec76000e1000660006000eec86000e1000660006000eec96000e1000660006000eeca6000e1000660006000eecb6000e1000660006000eecc6000e1000660006000eecd6000e1000660006000eece6000e1000660006000eecf6000e1000660006000eed06000e1000660006000eed16000e1000660006000eed26000e1000660006000eed36000e1000660006000eed46000e1000660006000eed56000e1000660006000eed66000e1000660006000eed76000e1000660006000eed86000e1000660006000eed96000e1000660006000eeda6000e1000660006000eedb6000e1000660006000eedc6000e1000660006000eedd6000e1000660006000eede6000e1000660006000eedf6000e1000660006000eee06000e1000660006000eee16000e1000660006000eee26000e1000660006000eee36000e1000660006000eee46000e1000660006000eee56000e1000660006000eee66000e1000660006000eee76000e1000660006000eee86000e1000660006000eee96000e1000660006000eeea6000e1000660006000eeeb6000e1000660006000eeec6000e1000660006000eeed6000e1000660006000eeee6000e1000660006000eeef6000e1000660006000eef06000e1000660006000eef16000e1000660006000eef26000e1000660006000eef36000e1000660006000eef46000e1000660006000eef56000e1000660006000eef66000e1000660006000eef76000e1000660006000eef86000e1000660006000eef96000e1000660006000eefa6000e1000660006000eefb6000e1000660006000eefc6000e1000660006000eefd6000e1000660006000eefe6000e1000660006000eeff60006000fdef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000feef000101000402000100010400000000800000fe
